{% extends 'metrics/base.html' %}
{% block pagetitle %}Projects{% endblock %}
{% block title %}{{ header }}{% endblock %}
{% block js %}{% endblock %}
{% block picker %}{% endblock %}
{% block primary %}
  {% regroup story by track as sorted_story %}
  <div style="float: left">
  {% if story %}
      <table class="publish" cellpadding="5">
        <tr>
          <th class="publish" >Track</th>
          <th class="publish">Business Area</th>
          <th class="left">Name</th>
          <th class="left">Process Lead</th>
          <th class="left">User Story</th>
          <th class="left">Status</th>
        </tr>
        {% for x in sorted_story %}
            {% for y in x.list %} 
              {% if y.blocked = "Y" %}
              <tr class="alert-danger">
              {% else %}
              <tr>
              {% endif %}
              {% if forloop.first %}
                 <td class="first" rowspan="{{ forloop.revcounter }}">{{ x.grouper|default_if_none:"Unknown" }}</td>
              {% endif %}
              <td class="center" style="width: 8%">{{ y.module|default_if_none:"All" }} </td>
              <td class="publish" style="width: 25%">
                {{ y.description }}{% if y.blocked = "Y" %}&nbsp;<span class="glyphicon glyphicon-ban-circle"></span>{% endif %}</td>
              <td class="publish" style="width: 10%">{{ y.globalLead|default_if_none:"" }}</td>
              <td class="publish" style="width: 8%"><a href="{{ y.storyURL }}" target="_blank">{{ y.rallyNumber }}</a></td>
              <td class="publish" style="width: 10%">{{ y.get_status_display }}</td>
            </tr>
            {% endfor %}
        {% endfor %}
        </tr></table>
    {% else %}
      <p>{{ exception }}
    {% endif %}
    </div>
{% endblock %}
